<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–¥–ª—è –ú–æ–Ω—è—á–∫–∏!</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body { 
            margin: 0; padding: 0; 
            background-color: #ffe6f0;
            background-image: radial-gradient(#ffb3d1 10%, transparent 10%);
            background-size: 20px 20px;
            overflow: hidden; 
            font-family: 'Press Start 2P', cursive; 
            touch-action: manipulation; 
        }

        #secret-btn { position: absolute; top: 20px; right: 20px; padding: 10px; background: #ffb3d1; border: 3px solid #ff4d6d; font-size: 8px; color: #330000; cursor: pointer; z-index: 1000; }

        .clickable-heart { position: absolute; font-size: 40px; cursor: pointer; z-index: 10; transition: opacity 0.8s ease; user-select: none; line-height: 1; }

        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 230, 240, 0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; padding: 20px; box-sizing: border-box; }
        .note { background: white; padding: 20px; border: 4px solid #ff4d6d; max-width: 90%; font-size: 10px; line-height: 1.6; color: #330000; text-align: center; }

        #secret-box { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffe6f0; display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 5000; padding: 20px; box-sizing: border-box; }
        #secret-box input { padding: 12px; font-family: 'Press Start 2P'; border: 3px solid #ff4d6d; text-align: center; margin-bottom: 15px; width: 80%; outline: none; font-size: 12px; background: white; }
        
        #error-msg { color: #ff4d6d; font-size: 7px; margin-bottom: 10px; line-height: 1.4; display: none; max-width: 80%; text-align: center; }

        .back-btn { padding: 8px 15px; font-family: 'Press Start 2P'; font-size: 8px; background: #ffb3d1; border: 3px solid #ff4d6d; cursor: pointer; color: #330000; margin: 5px; }

        #poem-area { width: 100%; height: 100%; display: none; flex-direction: column; align-items: center; justify-content: center; position: absolute; top: 0; left: 0; z-index: 6000; }
        .poem-text { font-size: 9px; line-height: 1.6; text-align: center; color: #330000; white-space: pre-wrap; width: 90%; max-height: 70vh; overflow-y: auto; margin-bottom: 10px; pointer-events: none; }

        #final-msg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 4px solid #ff4d6d; padding: 20px; text-align: center; display: none; z-index: 4000; font-size: 10px; width: 80%; line-height: 1.5; }
        
        .footer-credit { position: fixed; bottom: 15px; right: 15px; font-size: 8px; color: #ff4d6d; z-index: 5; font-weight: bold; }
    </style>
</head>
<body>

<div id="secret-btn">–°–ï–ö–†–ï–¢</div>

<div id="overlay">
    <div id="big-heart-icon" style="font-size: 50px; margin-bottom: 15px;">üíñ</div>
    <div class="note" id="note-text"></div>
</div>

<div id="secret-box">
    <div id="code-area">
        <div id="error-msg">–æ–π, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ø–æ–ø—Ä–æ–±—É–π –ø–æ–∏—Å–∫–∞—Ç—å –∫–æ–¥, –º–æ–∂–µ—Ç –æ–Ω –≥–¥–µ-—Ç–æ —Å–ø—Ä—è—Ç–∞–ª—Å—è?</div>
        <p style="font-size: 9px; margin-bottom: 15px;">–í–≤–µ–¥–∏ –∫–æ–¥:</p>
        <input type="text" id="code-input" placeholder="******" maxlength="6" inputmode="numeric">
        <br>
        <button class="back-btn" onclick="closeSecret()">–ù–∞–∑–∞–¥</button>
    </div>
    <div id="poem-area">
        <div class="poem-text" id="poem-content"></div>
        <button id="poem-back-btn" class="back-btn" style="display:none; pointer-events: auto;" onclick="closeSecret()">–ù–∞–∑–∞–¥</button>
    </div>
</div>

<div id="final-msg">–ö–æ–Ω–µ—Ü! –¢—ã –ø–æ–π–º–∞–ª–∞ –≤—Å–µ—Ö –∫–æ—Ç—è—Ç.<br><br>–ù–∞–¥–µ—é—Å—å –¢–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å, —è —Å—Ç–∞—Ä–∞–ª—Å—è.</div>

<div class="footer-credit">special for –°–æ—Ñ–∏—è –ú—è—É–∫–æ–≤–Ω–∞</div>

<script>
    // –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∑–≤—É–∫–∏
    const popSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3'); 
    const typeSound = new Audio('https://assets.mixkit.co/active_storage/sfx/444/444-preview.mp3');
    const winSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2019/2019-preview.mp3'); // –ú–∞–≥–∏—á–µ—Å–∫–∏–π –∑–≤—É–∫
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è "—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏" –∑–≤—É–∫–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
    function unlockAudio() {
        popSound.play().then(() => { popSound.pause(); popSound.currentTime = 0; });
        typeSound.play().then(() => { typeSound.pause(); typeSound.currentTime = 0; });
        winSound.play().then(() => { winSound.pause(); winSound.currentTime = 0; });
        document.removeEventListener('click', unlockAudio);
    }
    document.addEventListener('click', unlockAudio);

    let mainPhrases = [
        "–¢—ã - –ø—Ä–∏—á–∏–Ω–∞ –º–æ–µ–π —Å–∞–º–æ–π –∏—Å–∫—Ä–µ–Ω–Ω–µ–π —É–ª—ã–±–∫–∏",
        "–¢—ã –¥–µ–ª–∞–µ—à—å –º–æ—é –∂–∏–∑–Ω—å —è—Ä—á–µ, —á–µ–º —á—Ç–æ –ª–∏–±–æ –µ—â–µ",
        "–¢–≤–æ–π –≥–æ–ª–æ—Å - –º–æ—è –ª—é–±–∏–º–∞—è –º—É–∑—ã–∫–∞",
        "—Å–ª—É—à–∞–ª –±—ã –¢–µ–±—è –≤–µ—á–Ω–æ",
        "—Å–∫—É—á–∞—é –ø–æ –¢–µ–±–µ –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–ø–ª—é",
        "–≤ –º–∏—Ä–µ 16 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –≥–ª–∞–∑, –Ω–æ –¢–≤–æ–∏ —Å–∞–º—ã–µ –∫—Ä–∞—Å–∏–≤—ã–µ",
        "—Ä–∞–∑–≥–æ–≤–æ—Ä—ã —Å –¢–æ–±–æ–π - –ª—É—á—à–∞—è —Ç–µ—Ä–∞–ø–∏—è",
        "–≤—Å–µ–≥–¥–∞ –±–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω –≤ —Ä—É–∫–∏ —Ç–æ–ª—å–∫–æ —Å –Ω–∞–¥–µ–∂–¥–æ–π —É–≤–∏–¥–µ—Ç—å –¢–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
        "–Ω–µ –∑–Ω–∞—é —á—Ç–æ —Ç–∞–º —á—É–≤—Å—Ç–≤–æ–≤–∞–ª –∫–æ–ª—É–º–± –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã–ª –∞–º–µ—Ä–∏–∫—É, –Ω–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ —Å—Ä–∞–≤–Ω–∏—Ç—Å—è —Å —Ç–µ–º —á—Ç–æ —è –∏—Å–ø—ã—Ç—ã–≤–∞—é –∫–æ–≥–¥–∞ —Å–ª—É—à–∞—é –¢–≤–æ–π –≥–æ–ª–æ—Å",
        "–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —è —É–ª—ã–±–∞—é—Å—å –∑–∞ –º–∏–Ω—É—Ç—É –æ–±—â–µ–Ω–∏—è —Å –¢–æ–±–æ–π",
        "—Å –¢–æ–±–æ–π —è —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è —Å–∞–º–∏–º —Å–æ–±–æ–π",
        "–¢—ã –∫–∞–∫ –∫–æ—Ç–µ–Ω–æ–∫, —Ç–∞–∫–∞—è –∂–µ –º–∏–ª–∞—è",
        "–¢—ã –∫–∞–∫ —Ü–≤–µ—Ç–æ—á–µ–∫ –≤ —Å—Ç–µ–∫–ª–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏ –±–µ—Ä–µ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å."
    ];

    const heartIcons = ['üíò','üíù','üíñ','üíó','üíì','ü©∑'];
    let caughtCount = 0;
    let isFinished = false;
    let codeAccepted = false;
    let isTyping = false;
    let step = 0;
    let codeFound = false;

    function createHeart(index, total) {
        const h = document.createElement('div');
        h.className = 'clickable-heart';
        h.innerText = heartIcons[index % heartIcons.length];
        let x = Math.random() * (window.innerWidth - 60);
        let y = Math.random() * (window.innerHeight - 60);
        let dx = (Math.random() - 0.5) * 2.5; 
        let dy = (Math.random() - 0.5) * 2.5;

        function move() {
            if (document.getElementById('overlay').style.display !== 'flex' && document.getElementById('secret-box').style.display !== 'flex') {
                x += dx; y += dy;
                if (x <= 0 || x >= window.innerWidth - 60) dx *= -1;
                if (y <= 0 || y >= window.innerHeight - 60) dy *= -1;
                h.style.left = x + 'px';
                h.style.top = y + 'px';
            }
            requestAnimationFrame(move);
        }

        h.onclick = () => {
            if(h.style.opacity === "0") return;
            popSound.currentTime = 0;
            popSound.play().catch(()=>{});
            caughtCount++;
            
            let currentText = "";
            if (caughtCount >= 6 && !codeFound) {
                if (Math.random() > 0.6 || caughtCount === total) {
                    currentText = "–∫–æ–¥: 050909";
                    codeFound = true;
                } else {
                    currentText = mainPhrases.pop();
                }
            } else {
                currentText = mainPhrases.pop();
            }

            document.getElementById('note-text').innerText = currentText || "–¢—ã –ø—Ä–æ—Å—Ç–æ —á—É–¥–æ!";
            document.getElementById('big-heart-icon').innerText = h.innerText;
            document.getElementById('overlay').style.display = 'flex';
            h.style.opacity = '0';
            h.style.pointerEvents = 'none';
            
            if(caughtCount === total) {
                isFinished = true;
            }
        };
        document.body.appendChild(h);
        move();
    }

    function triggerWin() {
        winSound.currentTime = 0;
        winSound.play().catch(()=>{});
        confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 },
            colors: ['#ff4d6d', '#ffb3d1', '#ffffff']
        });
    }

    mainPhrases.sort(() => Math.random() - 0.5);
    const totalHearts = mainPhrases.length + 1;
    for(let i=0; i < totalHearts; i++) {
        createHeart(i, totalHearts);
    }

    document.getElementById('overlay').onclick = function() {
        this.style.display = 'none';
        if(isFinished) {
            document.getElementById('final-msg').style.display = 'block';
            triggerWin(); 
        }
    };

    const secretBox = document.getElementById('secret-box');
    const poemArea = document.getElementById('poem-area');
    const codeArea = document.getElementById('code-area');
    const codeInput = document.getElementById('code-input');
    const errorMsg = document.getElementById('error-msg');
    const poemContent = document.getElementById('poem-content');

    document.getElementById('secret-btn').onclick = () => {
        secretBox.style.display = 'flex';
        document.getElementById('final-msg').style.display = 'none';
        if(codeAccepted) {
            codeArea.style.display = 'none';
            poemArea.style.display = 'flex';
            showFullPoem();
        }
    };

    codeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') checkCode(); });

    function checkCode() {
        if(codeInput.value === '050909') {
            codeAccepted = true;
            errorMsg.style.display = 'none';
            codeArea.style.display = 'none';
            poemArea.style.display = 'flex';
            step = 1;
            typeWriter("—É–º–Ω–∏—á–∫–∞!", poemContent);
        } else {
            errorMsg.style.display = 'block';
            codeInput.value = '';
        }
    }

    poemArea.onclick = () => {
        if(isTyping) return;
        if(step === 1) {
            step = 2;
            typeWriter("–≠—Ç–æ—Ç —Å—Ç–∏—Ö —è –Ω–∞–ø–∏—Å–∞–ª –¥–ª—è –¢–µ–±—è –∏ –ø–æ—Å–≤—è—â–∞—é –¢–µ–±–µ:", poemContent);
        } else if(step === 2) {
            step = 3;
            showFullPoem();
        }
    };

    function typeWriter(text, element, callback) {
        let i = 0;
        element.innerText = "";
        isTyping = true;
        function type() {
            if (i < text.length) {
                element.innerText += text.charAt(i);
                typeSound.currentTime = 0;
                typeSound.play().catch(()=>{});
                i++;
                setTimeout(type, 60);
            } else {
                isTyping = false;
                if(callback) callback();
            }
        }
        type();
    }

    function showFullPoem() {
        const poem = `–¢—ã –≥—Ä–µ–µ—à—å –º–æ–µ —Å–µ—Ä–¥—Ü–µ, –±—É–¥—Ç–æ –ø—Ä–∏—à–ª–∞ –≤–µ—Å–Ω–∞,\n—è –Ω–µ –≤–µ—Ä—é –≤ —Å–≤–æ–µ —Å—á–∞—Å—Ç—å–µ, –≤–µ–¥—å —Å—á–∞—Å—Ç—å–µ - –¢—ã –æ–¥–Ω–∞.\n–¢—ã –±—ã–≤–∞–µ—à—å –≤ –º–æ–∏—Ö –º—ã—Å–ª—è—Ö, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–ø–∏—à—å,\n–∏ –µ—Å–ª–∏ —è –Ω–µ —Å–ø–ª—é, –¢—ã –≤ –≥–æ–ª–æ–≤–µ –º–æ–µ–π –∑–≤—É—á–∏—à—å.\n\n–º–Ω–µ –±—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ –≥—Ä—É—Å—Ç–Ω–æ, –∏ –≤ –∫–æ–º–Ω–∞—Ç–µ —Ç–µ–º–Ω–æ,\n–Ω–æ –µ—Å–ª–∏ —Ä—è–¥–æ–º –¢—ã, –Ω–∞ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ.\n—è —Å–Ω–æ–≤–∞ –¥–æ–ª–≥–æ –¥—É–º–∞–ª, —Å –Ω–æ—á–∏ –¥–æ —É—Ç—Ä–∞,\n—á—Ç–æ –º–Ω–µ –Ω–∏–∫—Ç–æ –Ω–µ –Ω—É–∂–µ–Ω, –Ω—É–∂–Ω–∞ –ª–∏—à—å –¢—ã –æ–¥–Ω–∞.\n\n–¢–≤–æ–π –≥–æ–ª–æ—Å –ª–µ—á–∏—Ç –¥—É—à—É, –≤ –Ω–µ–º —Å—Ç–æ–ª—å–∫–æ –¥–æ–±—Ä–æ—Ç—ã,\n—è –≤ –Ω–µ–º —Ö–æ—á—É –æ—Å—Ç–∞—Ç—å—Å—è, –≤ –Ω–µ–º –Ω–µ—Ç —Ç–æ–π –ø—É—Å—Ç–æ—Ç—ã.\n—Å –¢–æ–±–æ–π —è –Ω–∞—É—á–∏–ª—Å—è —Å–≤–æ–π –∫–∞–∂–¥—ã–π –º–∏–≥ —Ü–µ–Ω–∏—Ç—å.\n–¢—ã - –ª—É—á—à–µ–µ, —á—Ç–æ –∂–∏–∑–Ω—å –º–æ–≥–ª–∞ –º–Ω–µ –ø–æ–¥–∞—Ä–∏—Ç—å.`;
        poemContent.innerText = poem;
        document.getElementById('poem-back-btn').style.display = 'inline-block';
    }

    function closeSecret() {
        secretBox.style.display = 'none';
        errorMsg.style.display = 'none';
        if(isFinished) document.getElementById('final-msg').style.display = 'block';
    }
</script>
</body>
</html>
