<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–¥–ª—è –ú–æ–Ω—è—á–∫–∏</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body { 
            margin: 0; padding: 0; 
            background-color: #ffe6f0;
            background-image: radial-gradient(#ffb3d1 10%, transparent 10%);
            background-size: 20px 20px;
            overflow: hidden; 
            font-family: 'Press Start 2P', cursive; 
            touch-action: manipulation; 
        }

        #secret-btn { position: absolute; top: 20px; right: 20px; padding: 10px; background: #ffb3d1; border: 3px solid #ff4d6d; font-size: 8px; color: #330000; cursor: pointer; z-index: 1000; }

        .clickable-heart { position: absolute; font-size: 40px; cursor: pointer; z-index: 10; transition: opacity 0.8s ease; user-select: none; line-height: 1; }

        #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 230, 240, 0.95); display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 2000; padding: 20px; box-sizing: border-box; }
        .note { background: white; padding: 20px; border: 4px solid #ff4d6d; max-width: 90%; font-size: 10px; line-height: 1.6; color: #330000; text-align: center; margin-top: 20px; }

        #secret-box { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #ffe6f0; display: none; flex-direction: column; justify-content: center; align-items: center; z-index: 5000; padding: 20px; box-sizing: border-box; }
        #secret-box input { padding: 12px; font-family: 'Press Start 2P'; border: 3px solid #ff4d6d; text-align: center; margin-bottom: 15px; width: 80%; outline: none; font-size: 12px; background: white; }
        
        #error-msg { color: #ff4d6d; font-size: 7px; margin-bottom: 10px; line-height: 1.4; display: none; max-width: 80%; text-align: center; }

        .back-btn { padding: 8px 15px; font-family: 'Press Start 2P'; font-size: 8px; background: #ffb3d1; border: 3px solid #ff4d6d; cursor: pointer; color: #330000; margin: 5px; }

        #poem-area { width: 100%; height: 100%; display: none; flex-direction: column; align-items: center; justify-content: center; position: absolute; top: 0; left: 0; z-index: 6000; }
        .poem-text { font-size: 9px; line-height: 1.6; text-align: center; color: #330000; white-space: pre-wrap; width: 90%; max-height: 70vh; overflow-y: auto; margin-bottom: 10px; pointer-events: none; }

        #final-msg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 4px solid #ff4d6d; padding: 20px; text-align: center; display: none; z-index: 4000; font-size: 10px; width: 80%; line-height: 1.5; }
        
        .footer-credit { position: fixed; bottom: 15px; right: 15px; font-size: 8px; color: #ff4d6d; z-index: 5; font-weight: bold; }
    </style>
</head>
<body>

<div id="secret-btn">–°–ï–ö–†–ï–¢</div>

<div id="overlay">
    <div id="big-heart-icon" style="font-size: 50px;">üíñ</div>
    <div class="note" id="note-text"></div>
    <p style="font-size: 7px; margin-top: 15px;">(–Ω–∞–∂–º–∏, —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å)</p>
</div>

<div id="secret-box">
    <div id="code-area">
        <div id="error-msg">–æ–π, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ø–æ–ø—Ä–æ–±—É–π –ø–æ–∏—Å–∫–∞—Ç—å –∫–æ–¥, –º–æ–∂–µ—Ç –æ–Ω –≥–¥–µ-—Ç–æ —Å–ø—Ä—è—Ç–∞–ª—Å—è?</div>
        <p style="font-size: 9px; margin-bottom: 15px;">–í–≤–µ–¥–∏ –∫–æ–¥:</p>
        <input type="text" id="code-input" placeholder="******" maxlength="6" inputmode="numeric">
        <br>
        <button class="back-btn" onclick="closeSecret()">–ù–∞–∑–∞–¥</button>
    </div>
    <div id="poem-area">
        <div class="poem-text" id="poem-content"></div>
        <button id="poem-back-btn" class="back-btn" style="display:none; pointer-events: auto;" onclick="closeSecret()">–ù–∞–∑–∞–¥</button>
        <p id="tap-hint" style="font-size: 6px; margin-top: 10px; color: #ff4d6d; display:none;">(–Ω–∞–∂–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω)</p>
    </div>
</div>

<div id="final-msg">–ö–æ–Ω–µ—Ü! –¢—ã –ø–æ–π–º–∞–ª–∞ –≤—Å–µ—Ö –∫–æ—Ç—è—Ç.<br><br>–ù–∞–¥–µ—é—Å—å –¢–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å, —è —Å—Ç–∞—Ä–∞–ª—Å—è.</div>

<div class="footer-credit">special for –°–æ—Ñ–∏—è –ú—è—É–∫–æ–≤–Ω–∞</div>

<script>
    const popSound = new Audio('https://pixabay.com/static/audio/2022/03/15/audio_783850666a.mp3');
    const typeSound = new Audio('https://pixabay.com/static/audio/2022/03/10/audio_c33038a201.mp3');
    
    // –§—Ä–∞–∑—ã –±–µ–∑ –∫–æ–¥–∞ (–∫–æ–¥ –¥–æ–±–∞–≤–∏–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏)
    let mainPhrases = [
        "–¢—ã - –ø—Ä–∏—á–∏–Ω–∞ –º–æ–µ–π —Å–∞–º–æ–π –∏—Å–∫—Ä–µ–Ω–Ω–µ–π —É–ª—ã–±–∫–∏",
        "–¢—ã –¥–µ–ª–∞–µ—à—å –º–æ—é –∂–∏–∑–Ω—å —è—Ä—á–µ, —á–µ–º —á—Ç–æ –ª–∏–±–æ –µ—â–µ",
        "–¢–≤–æ–π –≥–æ–ª–æ—Å - –º–æ—è –ª—é–±–∏–º–∞—è –º—É–∑—ã–∫–∞",
        "—Å–ª—É—à–∞–ª –±—ã –¢–µ–±—è –≤–µ—á–Ω–æ",
        "—Å–∫—É—á–∞—é –ø–æ –¢–µ–±–µ –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–ø–ª—é",
        "–≤ –º–∏—Ä–µ 16 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤ –≥–ª–∞–∑, –Ω–æ –¢–≤–æ–∏ —Å–∞–º—ã–µ –∫—Ä–∞—Å–∏–≤—ã–µ",
        "—Ä–∞–∑–≥–æ–≤–æ—Ä—ã —Å –¢–æ–±–æ–π - –ª—É—á—à–∞—è —Ç–µ—Ä–∞–ø–∏—è",
        "–≤—Å–µ–≥–¥–∞ –±–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω –≤ —Ä—É–∫–∏ —Ç–æ–ª—å–∫–æ —Å –Ω–∞–¥–µ–∂–¥–æ–π —É–≤–∏–¥–µ—Ç—å –¢–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
        "–Ω–µ –∑–Ω–∞—é —á—Ç–æ —Ç–∞–º —á—É–≤—Å—Ç–≤–æ–≤–∞–ª –∫–æ–ª—É–º–± –∫–æ–≥–¥–∞ –æ—Ç–∫—Ä—ã–ª –∞–º–µ—Ä–∏–∫—É, –Ω–æ —ç—Ç–æ —Ç–æ—á–Ω–æ –Ω–µ —Å—Ä–∞–≤–Ω–∏—Ç—Å—è —Å —Ç–µ–º —á—Ç–æ —è –∏—Å–ø—ã—Ç—ã–≤–∞—é –∫–æ–≥–¥–∞ —Å–ª—É—à–∞—é –¢–≤–æ–π –≥–æ–ª–æ—Å",
        "–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ—Å—á–∏—Ç–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —è —É–ª—ã–±–∞—é—Å—å –∑–∞ –º–∏–Ω—É—Ç—É –æ–±—â–µ–Ω–∏—è —Å –¢–æ–±–æ–π",
        "—Å —Ç—Ä—É–¥–æ–º —è —á—É–≤—Å—Ç–≤—É—é —Å–µ–±—è —Å–∞–º–∏–º —Å–æ–±–æ–π",
        "–¢—ã –∫–∞–∫ –∫–æ—Ç–µ–Ω–æ–∫, —Ç–∞–∫–∞—è –∂–µ –º–∏–ª–∞—è",
        "–¢—ã –∫–∞–∫ —Ü–≤–µ—Ç–æ—á–µ–∫ –≤ —Å—Ç–µ–∫–ª–µ, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –∏ –±–µ—Ä–µ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å."
    ];

    const heartIcons = ['üíò','üíù','üíñ','üíó','üíì','ü©∑'];
    let caughtCount = 0;
    let isFinished = false;
    let codeAccepted = false;
    let isTyping = false;
    let step = 0;
    let codeIndex = -1; // –ò–Ω–¥–µ–∫—Å —Å–µ—Ä–¥–µ—á–∫–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –∫–æ–¥

    function createHeart(index, total) {
        const h = document.createElement('div');
        h.className = 'clickable-heart';
        h.innerText = heartIcons[index % heartIcons.length];
        let x = Math.random() * (window.innerWidth - 60);
        let y = Math.random() * (window.innerHeight - 60);
        let dx = (Math.random() - 0.5) * 2; 
        let dy = (Math.random() - 0.5) * 2;

        function move() {
            if (document.getElementById('overlay').style.display !== 'flex' && document.getElementById('secret-box').style.display !== 'flex') {
                x += dx; y += dy;
                if (x <= 0 || x >= window.innerWidth - 60) dx *= -1;
                if (y <= 0 || y >= window.innerHeight - 60) dy *= -1;
                h.style.left = x + 'px';
                h.style.top = y + 'px';
            }
            requestAnimationFrame(move);
        }

        h.onclick = () => {
            if(h.style.opacity === "0") return;
            popSound.currentTime = 0;
            popSound.play().catch(()=>{});
            
            caughtCount++;
            
            // –õ–æ–≥–∏–∫–∞ –≤—ã–¥–∞—á–∏ —Ç–µ–∫—Å—Ç–∞: –µ—Å–ª–∏ —ç—Ç–æ –ü–Ø–¢–û–ï –ø–æ–π–º–∞–Ω–Ω–æ–µ —Å–µ—Ä–¥–µ—á–∫–æ –∏–ª–∏ –ø–æ–∑–∂–µ, –∏ –∫–æ–¥ –µ—â–µ –Ω–µ –≤—ã–¥–∞–Ω
            let currentText = "";
            if (caughtCount >= 6 && codeIndex === -1) {
                // –° —à–∞–Ω—Å–æ–º 30% –∏–ª–∏ –µ—Å–ª–∏ —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–µ—Ä–¥–µ—á–∫–æ ‚Äî –¥–∞–µ–º –∫–æ–¥
                if (Math.random() > 0.7 || caughtCount === total) {
                    currentText = "–∫–æ–¥: 050909";
                    codeIndex = caughtCount;
                } else {
                    currentText = mainPhrases.pop();
                }
            } else {
                currentText = mainPhrases.pop();
            }

            document.getElementById('note-text').innerText = currentText || "–¢—ã –ø—Ä–æ—Å—Ç–æ —á—É–¥–æ!";
            document.getElementById('big-heart-icon').innerText = h.innerText;
            document.getElementById('overlay').style.display = 'flex';
            h.style.opacity = '0';
            h.style.pointerEvents = 'none';
            
            if(caughtCount === total) isFinished = true;
        };
        document.body.appendChild(h);
        move();
    }

    // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Ñ—Ä–∞–∑—ã
    mainPhrases.sort(() => Math.random() - 0.5);
    const totalHearts = mainPhrases.length + 1; // +1 –¥–ª—è —Ñ—Ä–∞–∑—ã —Å –∫–æ–¥–æ–º
    for(let i=0; i < totalHearts; i++) {
        createHeart(i, totalHearts);
    }

    document.getElementById('overlay').onclick = function() {
        this.style.display = 'none';
        if(isFinished) document.getElementById('final-msg').style.display = 'block';
    };

    const secretBox = document.getElementById('secret-box');
    const poemArea = document.getElementById('poem-area');
    const codeArea = document.getElementById('code-area');
    const codeInput = document.getElementById('code-input');
    const errorMsg = document.getElementById('error-msg');
    const poemContent = document.getElementById('poem-content');

    document.getElementById('secret-btn').onclick = () => {
        secretBox.style.display = 'flex';
        document.getElementById('final-msg').style.display = 'none';
        if(codeAccepted) {
            codeArea.style.display = 'none';
            poemArea.style.display = 'flex';
            showFullPoem();
        }
    };

    codeInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') checkCode(); });

    function checkCode() {
        if(codeInput.value === '050909') {
            codeAccepted = true;
            errorMsg.style.display = 'none';
            codeArea.style.display = 'none';
            poemArea.style.display = 'flex';
            step = 1;
            typeWriter("–£–º–Ω–∏—á–∫–∞!", poemContent, () => { document.getElementById('tap-hint').style.display = 'block'; });
        } else {
            errorMsg.style.display = 'block';
            codeInput.value = '';
        }
    }

    poemArea.onclick = () => {
        if(isTyping) return;
        if(step === 1) {
            step = 2;
            document.getElementById('tap-hint').style.display = 'none';
            typeWriter("–≠—Ç–æ—Ç —Å—Ç–∏—Ö —è –Ω–∞–ø–∏—Å–∞–ª –¥–ª—è –¢–µ–±—è –∏ –ø–æ—Å–≤—è—â–∞—é –¢–µ–±–µ:", poemContent, () => { 
                document.getElementById('tap-hint').style.display = 'block'; 
            });
        } else if(step === 2) {
            step = 3;
            document.getElementById('tap-hint').style.display = 'none';
            showFullPoem();
        }
    };

    function typeWriter(text, element, callback) {
        let i = 0;
        element.innerText = "";
        isTyping = true;
        
        function type() {
            if (i < text.length) {
                element.innerText += text.charAt(i);
                typeSound.currentTime = 0;
                typeSound.play().catch(()=>{});
                i++;
                setTimeout(type, 50);
            } else {
                isTyping = false;
                if(callback) callback();
            }
        }
        type();
    }

    function showFullPoem() {
        const poem = `–¢—ã –≥—Ä–µ–µ—à—å –º–æ–µ —Å–µ—Ä–¥—Ü–µ, –±—É–¥—Ç–æ –ø—Ä–∏—à–ª–∞ –≤–µ—Å–Ω–∞,\n—è –Ω–µ –≤–µ—Ä—é –≤ —Å–≤–æ–µ —Å—á–∞—Å—Ç—å–µ, –≤–µ–¥—å —Å—á–∞—Å—Ç—å–µ - –¢—ã –æ–¥–Ω–∞.\n–¢—ã –±—ã–≤–∞–µ—à—å –≤ –º–æ–∏—Ö –º—ã—Å–ª—è—Ö, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–ø–∏—à—å,\n–∏ –µ—Å–ª–∏ —è –Ω–µ —Å–ø–ª—é, –¢—ã –≤ –≥–æ–ª–æ–≤–µ –º–æ–µ–π –∑–≤—É—á–∏—à—å.\n\n–º–Ω–µ –±—ã–≤–∞–µ—Ç —á–∞—Å—Ç–æ –≥—Ä—É—Å—Ç–Ω–æ, –∏ –≤ –∫–æ–º–Ω–∞—Ç–µ —Ç–µ–º–Ω–æ,\n–Ω–æ –µ—Å–ª–∏ —Ä—è–¥–æ–º –¢—ã, –Ω–∞ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –≤—Å–µ —Ä–∞–≤–Ω–æ.\n—è —Å–Ω–æ–≤–∞ –¥–æ–ª–≥–æ –¥—É–º–∞–ª, —Å –Ω–æ—á–∏ –¥–æ —É—Ç—Ä–∞,\n—á—Ç–æ –º–Ω–µ –Ω–∏–∫—Ç–æ –Ω–µ –Ω—É–∂–µ–Ω, –Ω—É–∂–Ω–∞ –ª–∏—à—å –¢—ã –æ–¥–Ω–∞.\n\n–¢–≤–æ–π –≥–æ–ª–æ—Å –ª–µ—á–∏—Ç –¥—É—à—É, –≤ –Ω–µ–º —Å—Ç–æ–ª—å–∫–æ –¥–æ–±—Ä–æ—Ç—ã,\n—è –≤ –Ω–µ–º —Ö–æ—á—É –æ—Å—Ç–∞—Ç—å—Å—è, –≤ –Ω–µ–º –Ω–µ—Ç —Ç–æ–π –ø—É—Å—Ç–æ—Ç—ã.\n—Å –¢–æ–±–æ–π —è –Ω–∞—É—á–∏–ª—Å—è —Å–≤–æ–π –∫–∞–∂–¥—ã–π –º–∏–≥ —Ü–µ–Ω–∏—Ç—å.\n–¢—ã - –ª—É—á—à–µ–µ, —á—Ç–æ –∂–∏–∑–Ω—å –º–æ–≥–ª–∞ –º–Ω–µ –ø–æ–¥–∞—Ä–∏—Ç—å.`;
        poemContent.innerText = poem;
        document.getElementById('poem-back-btn').style.display = 'inline-block';
    }

    function closeSecret() {
        secretBox.style.display = 'none';
        errorMsg.style.display = 'none';
        if(isFinished) document.getElementById('final-msg').style.display = 'block';
    }
</script>
</body>
</html>
